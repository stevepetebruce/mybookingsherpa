<ul class="nav nav-pills mb-3" id="pills-tab" role="tablist">
  <li class="nav-item">
    <a class="nav-link active" id="pills-edit-tab" data-toggle="pill" href="#pills-edit" role="tab" aria-controls="pills-edit" aria-selected="true">Edit</a>
  </li>
  <li class="nav-item">
    <a class="nav-link" id="pills-preview-tab" data-toggle="pill" href="#pills-preview" role="tab" aria-controls="pills-preview" aria-selected="false">Preview</a>
  </li>
</ul>
<div class="tab-content" id="pills-tabContent">
  <div class="tab-pane fade show active row" id="pills-edit" role="tabpanel" aria-labelledby="pills-edit-tab"> 
    <%= form_with(model: @trip, url: url, local: true, class: "needs-validation", html: { novalidate: :novalidate }) do |form| %>
      <div class="row">
        <div class="col-md-5 order-md-2 mb-4">
          <ul class="list-group mb-3">
            <h4 class="mb-3">Price</h4>
            <li class="list-group-item d-flex justify-content-between lh-condensed">
              <div class="col-md-6 mb-3">
                <%= form.label :currency %>
                  <%= form.select :currency, options_for_select(Trip.currencies.map {|k, v| [k.upcase, k]  }.to_h, selected: @trip.currency), {}, { class: "form-control customselect", data: { target: "currency-select.source trip-preview.currencyInput", action: "currency-select#switchCurrency" }} %>
              </div>
              <div class="col-md-6 mb-3">
                <%= form.label :full_cost, "Cost per guest" %>
                <div class="input-group">
                  <div class="input-group-prepend">
                    <span class="input-group-text" id="inputGroupPrepend" data-target="currency-select.symbol"><%= Currency.iso_to_symbol(@trip.currency) %></span>
                  </div>
                  <%= form.number_field :full_cost, value: Currency.human_readable(@trip.full_cost), minimunm: 0, step: 1.0, data: { number_to_fixed: 2, number_stepfactor: 100, action: "keyup->trip-preview#previewUpdate", target: "trip-preview.fullCostInput" }, class: "form-control" %>
                </div>
              </div>
            </li>
          </ul>
          <h4 class="mb-3">Deposit <small class="text-muted text-small"> - leave blank if payment in full</small></h4>
          <ul class="list-group mb-3">
            <li class="list-group-item d-flex justify-content-between lh-condensed">
              <div class="mb-3">
                <%= form.label :deposit_percentage %>
                  <%= form.number_field :deposit_percentage, minimunm: 0, step: 1, data: { action: "keyup->trip-preview#previewUpdate", target: "trip-preview.depositPercentageInput" }, class: "form-control" %>
                  <small class="text-muted">Deposit (% of full trip cost)</small>
              </div>
            </li>
            <li class="list-group-item d-flex justify-content-between lh-condensed border-top-0 pt-0">
              <div class="mb-3">
                <%= form.label :full_payment_window_weeks, "Full payment window" %>
                  <%= form.number_field :full_payment_window_weeks, minimunm: 0, step: 1, data: { action: "keyup->trip-preview#previewUpdate", target: "trip-preview.paymentWindowWeeksInput" }, class: "form-control" %>
                  <small class="text-muted">Weeks before (trip start date) full payment required</small>
              </div>
            </li>
          </ul>
        </div>
        <div class="col-md-7 order-md-1">
          <h4 class="mb-3">Trip Details</h4>
          <div class="mb-3">
            <%= form.label :trip_name %>
            <%= form.text_field :name, class: "form-control #{'is-invalid' if @trip.errors[:name].present?}", data: { action: "keyup->trip-preview#previewUpdate", target: "trip-preview.nameInput" }, required: true, autofocus: auto_focus(@trip, form_field: :name) %>
            <div class="invalid-feedback">
              <%= "Please enter a valid trip name" %>
            </div>
            <% if @trip.errors[:name].present? %>
              <div class="invalid-feedback" style="display: block;">
                Please enter a valid trip name
              </div>
            <% end %>
          </div>
          <div class="row">
            <div class="col-md-6 mb-3">
              <%= form.label :start_date %>
              <%= form.date_field :start_date, class: "#{'is-invalid' if @trip.errors[:start_date].present?} form-control", data: { action: "keyup->trip-preview#previewUpdate", target: "trip-preview.startDateInput" }, required: true, autofocus: auto_focus(@trip, form_field: :start_date) %>
              <div class="invalid-feedback">
                <%= "Please enter a valid start date" %>
              </div>
              <% if @trip.errors[:start_date].present? %>
                <div class="invalid-feedback" style="display: block;">
                  Please enter a valid start date
                </div>
              <% end %>
            </div>
            <div class="col-md-6 mb-3">
              <%= form.label :end_date %>
              <%= form.date_field :end_date, class: "#{'is-invalid' if @trip.errors[:end_date].present?} form-control", data: { action: "keyup->trip-preview#previewUpdate", target: "trip-preview.endDateInput" }, required: true, autofocus: auto_focus(@trip, form_field: :end_date) %>
              <div class="invalid-feedback">
                <%= "Please enter a valid end date" %>
              </div>
              <% if @trip.errors[:end_date].present? %>
                <div class="invalid-feedback" style="display: block;">
                  Please enter a valid end date
                </div>
              <% end %>
            </div>
          </div>
          <div class="mb-3">
            <%= form.label :a_brief_description_of_your_trip %>
            <%= form.text_area :description, class: "#{'is-invalid' if @trip.errors[:description].present?} form-control", data: { action: "keyup->trip-preview#previewUpdate", target: "trip-preview.descriptionInput" }, required: true, rows: 8, autofocus: auto_focus(@trip, form_field: :description) %>
            <div class="invalid-feedback">
              <%= "Please enter a valid description" %>
            </div>
            <% if @trip.errors[:description].present? %>
              <div class="invalid-feedback" style="display: block;">
                Please enter a valid trip description
              </div>
            <% end %>
          </div>
          <h4 class="mt-3">Number of guests</h4>
          <div class="row">
            <div class="col-md-3 mb-3">
              <%= form.label :minimum_number_of_guests, "Minimum" %>
              <%= form.number_field :minimum_number_of_guests, minimunm: 0, step: 1, class: "form-control" %>
            </div>
            <div class="col-md-3 mb-3">
              <%= form.label :maximum_number_of_guests, "Maximum" %>
                <%= form.number_field :maximum_number_of_guests, minimum: 0, step: 1, class: "form-control" %>
            </div>
          </div>
        </div>
      </div>  
      <div class="mt-3 mb-5">
        <button class="btn btn-lg btn-primary btn-block" type="submit"><%= @trip.new_record? ? "Add Trip" : "Update Trip" %></button>
      </div> 
    <% end %>
  </div>
  <div class="tab-pane fade" id="pills-preview" role="tabpanel" aria-labelledby="pills-preview-tab"><div class="container-fluid full-height">
      <div class="row row-height border" style="overflow: hidden;">
        <div class="col-lg-4 content-left">
          <div class="content-left-wrapper bg_img">
            <div class="wrapper">
              <div class="py-4 text-center">
                
                <h1 class="font-weight-bold mb-0" data-target="trip-preview.namePreview">Trip Name</h1>
                <h3 class="mb-5" data-target="trip-preview.datePreview">
                  Dates displayed here
                </h3>
                <h2 class="mb-1"><span class="h4 mr-2 font-weight-light">Deposit due: </span> <span data-target="currency-select.symbol">€</span><span data-target="trip-preview.depositPreview"></span></h2>
                <h5 class="mb-3"><span data-target="trip-preview.currencyPreview">€</span><span data-target="trip-preview.depositRemainderPreview"></span> will be taken on <span data-target="trip-preview.depositDatePreview">Deposit date</span></h5>
                <h1><span class="h2 mr-3 font-weight-light">Total: <span data-target="currency-select.symbol">€</span><span data-target="trip-preview.fullCostPreview"></span></h1>
                <div id="summary" class="mt-5">
                  <p data-target="trip-preview.descriptionPreview" class="collapse" id="collapseSummary">
                    Description is displayed here...
                  </p>
                  <a class="collapsed" data-toggle="collapse" href="#collapseSummary" aria-expanded="false" aria-controls="collapseSummary"></a>
                </div>
              </div>
            </div>
          </div>
        </div>
        <div class="col content-right new-onboarding">
          <form>
            <h4 class="mb-3 font-weight-bold">Your Details</h4>  
            <div class="row">
              <div class="col-md-12 mb-3">
                <label for="booking_name">Full Name</label>
                <input value="Boris Johnson" class=" form-control" autofocus="autofocus" required="required" readonly="readonly" type="text" name="booking[name]" id="booking_name">
                <div class="invalid-feedback">
                  Please enter your name
                </div>
              </div>
            </div>
            <div class="mb-3">
              <label for="booking_email">Email</label>
              <input value="b.johnson@gmail.com" class=" form-control" required="required" readonly="readonly" type="text" name="booking[email]" id="booking_email">
            </div>
            <hr class="mb-5 mb-4">
            <h4 class="mb-3 font-weight-bold">
              Payment of <span data-target="currency-select.symbol">€</span><span data-target="trip-preview.fullCostPreview"> </span>
              </h4>
            <div class="row">
              <div class="col-md-12 mb-3">
                  <span>Credit or debit card number</span> <span style="padding-left: 235px;">MM / YY</span> <span style="padding-left: 18px;">CVC</span>
                  <input type="text" name="fake_card_details" id="fake_card_details" value="4242 4242 4242 4242                                                 10 / 20    123" class="form-control" required="required" readonly="readonly">
              </div>
            </div>
            <div class="actions">
              <input type="submit" name="commit" value="Book My Place" class="btn btn-primary btn-lg btn-block mt-4 mb-4">
            </div>
          </form>
        </div>
      </div>
    </div>
  </div>
</div>