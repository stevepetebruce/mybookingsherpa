<%= form_with(model: @trip, url: url, local: true, class: "needs-validation", html: { novalidate: :novalidate }) do |form| %>
  <%= form.label :trip_name %>
  <%= form.text_field :name, class: "form-control #{'is-invalid' if @trip.errors[:name].present?}", required: true, autofocus: auto_focus(@trip, form_field: :name) %>
  <div class="invalid-feedback">
    <%= "Please enter a valid trip name" %>
  </div>
  <% if @trip.errors[:name].present? %>
    <div class="invalid-feedback" style="display: block;">
      Please enter a valid trip name
    </div>
  <% end %>
  <div class="row mt-3">
    <div class="col-md-6">
      <%= form.label :start_date %>
      <%= form.date_field :start_date, class: "#{'is-invalid' if @trip.errors[:start_date].present?} form-control", required: true, autofocus: auto_focus(@trip, form_field: :start_date) %>
      <div class="invalid-feedback">
        <%= "Please enter a valid start date" %>
      </div>
      <% if @trip.errors[:start_date].present? %>
        <div class="invalid-feedback" style="display: block;">
          Please enter a valid start date
        </div>
      <% end %>
    </div>
    <div class="col-md-6">
      <%= form.label :end_date %>
      <%= form.date_field :end_date, class: "#{'is-invalid' if @trip.errors[:end_date].present?} form-control", required: true, autofocus: auto_focus(@trip, form_field: :end_date) %>
      <div class="invalid-feedback">
        <%= "Please enter a valid end date" %>
      </div>
      <% if @trip.errors[:end_date].present? %>
        <div class="invalid-feedback" style="display: block;">
          Please enter a valid end date
        </div>
      <% end %>
    </div>
  </div>
  <div class="mt-3 pb-1">
    <%= form.label :a_brief_description_of_your_trip %>
    <%= form.text_area :description, class: "#{'is-invalid' if @trip.errors[:description].present?} form-control", required: true, rows: 4, autofocus: auto_focus(@trip, form_field: :description) %>
    <div class="invalid-feedback">
      <%= "Please enter a valid description" %>
    </div>
    <% if @trip.errors[:description].present? %>
      <div class="invalid-feedback" style="display: block;">
        Please enter a valid trip description
      </div>
    <% end %>
  </div>
  <div class="row">
    <div class="col-md-12 col-lg-6">
      <h2 class="card-title font-weight-bold mt-4">
        Guests
      </h2>
      <div class="row">
        <div class="form-group row col-md-6">
          <%= form.label :minimum_number_of_guests, "Minimum per trip", class: "col-auto col-form-label" %>
          <div class="col-auto">
            <%= form.number_field :minimum_number_of_guests, minimunm: 0, step: 1, class: "form-control" %>
          </div>
        </div>
        <div class="form-group row col-md-6">
          <%= form.label :maximum_number_of_guests, "Maximum per trip", class: "col-auto col-form-label" %>
          <div class="col-auto">
            <%= form.number_field :maximum_number_of_guests, minimum: 0, step: 1, class: "form-control" %>
          </div>
        </div>
      </div>
    </div>
    <div class="col-md-12 col-lg-6">
      <h2 class="card-title font-weight-bold mt-4">
        Price
      </h2>
      <div class="row">
        <div class="form-group row col-md-6">
          <div class="col-auto">
            <%= form.label :currency, class: "col-auto col-form-label pl-0" %>
            <%= form.select :currency, options_for_select(Trip.currencies.map {|k, v| [k.upcase, k]  }.to_h, selected: @trip.currency), {}, { class: "form-control customSelect mr-sm-2 pr-4"} %>
          </div>
        </div>
        <div class="form-group row col-md-6">
          <%= form.label :full_cost, "Cost per guest", class: "col-auto col-form-label" %>
          <div class="col-auto">
            <div class="input-group">
              <div class="input-group-prepend">
                <span class="input-group-text" id="inputGroupPrepend"><%= Currency.iso_to_symbol(@trip.currency) %></span>
              </div>
              <%= form.number_field :full_cost, value: Currency.human_readable(@trip.full_cost), minimunm: 0, step: 1.0, data: { number_to_fixed: 2, number_stepfactor: 100 }, class: "form-control" %>
            </div>
          </div>
        </div>
      </div>
    </div>
  </div>
  <h2 class="card-title font-weight-bold mt-3">
    Deposit
    <span class="text-small font-weight-normal">(Optional - leave blank if full payment only)</span>
  </h2>
  <div class="row mt-3">
    <div class="form-group row col-md-6 col-lg-3">
      <%= form.label :deposit_percentage, "Deposit (% of full trip cost)", class: "col-auto col-form-label" %>
      <div class="col-auto">
        <%= form.number_field :deposit_percentage, minimunm: 0, step: 1, class: "form-control" %>
      </div>
    </div>
    <div class="form-group row col-md-6 col-lg-3">
      <%= form.label :full_payment_window_weeks, "Weeks before (trip start date) full payment required", class: "col-auto col-form-label" %>
      <div class="col-auto">
        <%= form.number_field :full_payment_window_weeks, minimunm: 0, step: 1, class: "form-control" %>
      </div>
    </div>
  </div>
  <div class="row mt-5 mb-5">
    <button class="btn btn-lg btn-primary btn-block" type="submit"><%= @trip.new_record? ? "Add Trip" : "Update Trip" %></button>
  </div>
<% end %>